CREATE DATABASE EXAMPLE3;

USE EXAMPLE3;

CREATE TABLE locations (
    location_id INT PRIMARY KEY,
    city VARCHAR(50)
);

CREATE TABLE departments (
    department_id INT PRIMARY KEY,
    department_name VARCHAR(50),
    location_id INT,
    FOREIGN KEY (location_id) REFERENCES locations(location_id)
);

CREATE TABLE employees (
    employee_id INT PRIMARY KEY,
    name VARCHAR(50),
    salary DECIMAL(10, 2),
    department_id INT,
    FOREIGN KEY (department_id) REFERENCES departments(department_id)
);

INSERT INTO locations (location_id, city) VALUES
(1, 'New York'),
(2, 'Los Angeles'),
(3, 'Chicago');

INSERT INTO departments (department_id, department_name, location_id) VALUES
(101, 'HR', 1),
(102, 'IT', 2),
(103, 'Finance', 3),
(104, 'Marketing', 1);

INSERT INTO employees (employee_id, name, salary, department_id) VALUES
(1, 'Alice', 75000, 101),
(2, 'Bob', 85000, 102),
(3, 'Charlie', 65000, 103),
(4, 'David', 90000, 102),
(5, 'Eva', 72000, 104),
(6, 'Frank', 82000, 101),
(7, 'Grace', 60000, 104);

-- 1
SELECT AVG(SALARY) FROM EMPLOYEES;
SELECT NAME FROM EMPLOYEES
WHERE SALARY > (SELECT AVG(SALARY) FROM EMPLOYEES);

-- 2
SELECT AVG(SALARY) FROM EMPLOYEES;
SELECT DEPARTMENT_ID,AVG(SALARY) AS AVG_SALARY
FROM EMPLOYEES
GROUP BY DEPARTMENT_ID
HAVING AVG(SALARY) > (SELECT AVG(SALARY) FROM EMPLOYEES);

-- 3
SELECT LOCATION_ID FROM LOCATIONS WHERE CITY = "NEW YORK";
SELECT DEPARTMENT_ID FROM DEPARTMENTS WHERE LOCATION_ID = 1;
SELECT NAME,DEPARTMENT_ID FROM EMPLOYEES WHERE DEPARTMENT_ID IN (101,104);
SELECT NAME,DEPARTMENT_ID FROM EMPLOYEES
WHERE DEPARTMENT_ID IN (
	SELECT DEPARTMENT_ID FROM DEPARTMENTS 
    WHERE LOCATION_ID = (SELECT LOCATION_ID FROM LOCATIONS WHERE CITY = "NEW YORK")
);

-- 4

SELECT DEPARTMENT_ID FROM DEPARTMENTS WHERE DEPARTMENT_NAME = "IT";
SELECT SALARY FROM EMPLOYEES WHERE DEPARTMENT_ID = 102;
SELECT NAME,SALARY FROM EMPLOYEES WHERE SALARY > ANY (85000,90000);
SELECT NAME,SALARY FROM EMPLOYEES
WHERE SALARY > ANY (
			SELECT SALARY FROM EMPLOYEES 
            WHERE DEPARTMENT_ID = (SELECT DEPARTMENT_ID FROM DEPARTMENTS 
									WHERE DEPARTMENT_NAME= "IT"
						)
);

-- 4
SELECT DEPARTMENT_ID FROM DEPARTMENTS WHERE DEPARTMENT_NAME = "HR";
SELECT SALARY FROM EMPLOYEES WHERE DEPARTMENT_ID = 101;
SELECT NAME,SALARY FROM EMPLOYEES WHERE SALARY > ALL (75000,82000);
SELECT NAME,SALARY FROM EMPLOYEES WHERE SALARY > ALL (
	SELECT SALARY FROM EMPLOYEES WHERE DEPARTMENT_ID = (
		SELECT DEPARTMENT_ID FROM DEPARTMENTS WHERE DEPARTMENT_NAME = "HR"
    )
);
SELECT * FROM EMPLOYEES;

-- 5
SELECT DEPARTMENT_ID FROM EMPLOYEES WHERE NAME = "ALICE";
SELECT LOCATION_ID FROM DEPARTMENTS WHERE DEPARTMENT_ID = (SUBQUERY);
SELECT NAME,DEPARTMENT_ID,SALARY FROM EMPLOYEES 
WHERE (DEPARTEMNT_ID,LOCATION_NAME) IN (SUBQUERY);

SELECT NAME,DEPARTMENT_ID,SALARY FROM EMPLOYEES
WHERE (DEPARTMENT_ID,
	(SELECT LOCATION_ID FROM DEPARTMENTS  
    WHERE DEPARTMENT_ID = EMPLOYEES.DEPARTMENT_ID))
IN (
	SELECT DEPARTMENT_ID,LOCATION_ID FROM DEPARTMENTS
	WHERE DEPARTMENT_ID = (SELECT DEPARTMENT_ID FROM EMPLOYEES WHERE NAME = "ALICE")
);